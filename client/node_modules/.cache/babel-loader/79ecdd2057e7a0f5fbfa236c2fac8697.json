{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Ben\\\\Desktop\\\\John Bryce\\\\\\u05E4\\u05E8\\u05D5\\u05D9\\u05D9\\u05E7\\u05D8\\u05D9\\u05DD\\\\project3 - Vacations\\\\client\\\\src\\\\components\\\\loginPage\\\\LoginPage.tsx\";\nimport React, { Component } from 'react';\nimport logo from \"../../assets/astronautSVG.svg\";\nimport UserLoginDetails from '../../models/UserLoginDetails';\nimport { NavLink } from 'react-router-dom';\nimport axios from 'axios';\nimport './loginPage.css';\nimport { store } from '../../Redux/Store';\nimport { ActionType } from '../../Redux/ActionType';\nimport TopBanner from '../topBanner/TopBanner';\nimport { successfulLoginHandler } from \"../../models/SuccessfulLoginHandler\"; // ------------------------------------------------- This Component Displays The Login Screen ------------------------------------------------- //\n\nexport default class LoginPage extends Component {\n  // Defining the global DOM elemends\n  constructor(props) {\n    super(props); // initializing the state with empty values\n\n    this.usernameInputField = void 0;\n    this.passwordInputField = void 0;\n    this.userMessagesParagraph = void 0;\n\n    this.componentDidMount = () => {\n      // Checking if the Global Store has the vacations.\n      // If not, retrieve them before the user even logs in, in order to load\n      // the vacations behind the scenes, while the user is bussy logging -> Better UX\n      this.checkIfGlobalStoreHasAllVacations(); // Defining global DOM elements\n\n      this.usernameInputField = document.querySelector(\"#usernameFieldset\");\n      this.passwordInputField = document.querySelector(\"#passwordFieldset\");\n      this.userMessagesParagraph = document.querySelector(\"#userMessagesParagraph\");\n    };\n\n    this.getAllVacationsFromServer = async () => {\n      try {\n        // The response we get, should be type of 'Vacation' class\n        const response = await axios.get('http://localhost:3001/vacations'); // Here we are receiving all the vacations from the server, as a JSON\n\n        const allVacations = response.data; // Updating the Global Store\n\n        store.dispatch({\n          type: ActionType.GetAllVacations,\n          payload: allVacations\n        });\n      } catch (error) {\n        try {\n          let errorMessage = error.response.data.error;\n          this.loginErrorHandler(errorMessage);\n        } catch {\n          this.loginErrorHandler(error);\n        }\n      }\n    };\n\n    this.login = async () => {\n      this.resetInputFields();\n      let userNameIsNotEmpty = this.checkIfUsernameEnteredIsEmpty();\n      let passwordIsNotEmpty = this.checkIfPasswordEnteredIsEmpty();\n\n      if (userNameIsNotEmpty && passwordIsNotEmpty) {\n        try {\n          this.disableLoginButton();\n          let userLoginDetails = new UserLoginDetails(this.state.userName, this.state.password); // The response we get, should be type of 'SuccessfulLoginServerResponse' class\n\n          const serverResponse = await axios.post('http://localhost:3001/users/login', userLoginDetails); // Here we are receiving the token, username & user type from the data we got back from the server\n\n          const serverResponseData = serverResponse.data; // A Model that handles a successful login response from the server\n\n          successfulLoginHandler(serverResponseData);\n          this.enableLoginBtn(); // Handling the URL routing\n\n          this.routingHandler();\n        } catch (error) {\n          try {\n            let errorMessage = error.response.data.error;\n            this.loginErrorHandler(errorMessage);\n          } catch {\n            this.loginErrorHandler(error);\n          } finally {\n            this.enableLoginBtn();\n          }\n        }\n      }\n    };\n\n    this.checkIfGlobalStoreHasAllVacations = () => {\n      let allVacationsInGlobalStore = store.getState().allVacations;\n\n      if (allVacationsInGlobalStore.length === 0) {\n        this.getAllVacationsFromServer();\n      }\n    };\n\n    this.updateUserNameValue = event => {\n      // getting the username entered in the username's input field\n      const userNameInputField = event.target;\n      const userNameInputFieldValue = userNameInputField.value;\n      const trimmedUserNameInputFieldValue = userNameInputFieldValue.trim();\n      this.setState({\n        userName: trimmedUserNameInputFieldValue\n      });\n    };\n\n    this.updatePasswordValue = event => {\n      // getting the password entered in the password's input field\n      const passwordInputField = event.target;\n      const passwordInputFieldValue = passwordInputField.value;\n      this.setState({\n        password: passwordInputFieldValue\n      });\n    };\n\n    this.initiateSocket = () => {\n      // Connecting to the server's socket\n      const userTokenForSocketIdentification = JSON.parse(sessionStorage.getItem('userInfo')).token;\n      this.socket = socketIOClient('http://localhost:3002', {\n        query: \"userToken=\" + userTokenForSocketIdentification\n      });\n      store.dispatch({\n        type: ActionType.ConnectToSocket,\n        payload: this.socket\n      });\n      this.registerAllSocketListeners();\n    };\n\n    this.checkIfUsernameEnteredIsEmpty = () => {\n      // Checking if the username entered in the 'login' page is empty\n      let userNameInputField = document.querySelector(\"#usernameField\");\n      let userNameInputFieldValue = userNameInputField.value;\n      let trimmedUserNameInputFieldValue = userNameInputFieldValue.trim();\n\n      if (trimmedUserNameInputFieldValue === \"\") {\n        this.notifyUserAboutInvalidUserName();\n        return false;\n      }\n\n      return true;\n    };\n\n    this.checkIfPasswordEnteredIsEmpty = () => {\n      // Checking if the password entered in the 'login' page is empty\n      let passwordInputField = document.querySelector(\"#passwordField\");\n      let passwordInputFieldValue = passwordInputField.value;\n      let trimmedUserNameInputFieldValue = passwordInputFieldValue.trim();\n\n      if (trimmedUserNameInputFieldValue === \"\") {\n        this.notifyUserAboutInvalidPassword();\n        return false;\n      }\n\n      return true;\n    };\n\n    this.routingHandler = () => {\n      // Navigating To The Vacations Page URL After a Successful Login\n      this.props.history.push('/vacations');\n    };\n\n    this.disableLoginButton = () => {\n      const loginBtn = document.querySelector(\"#loginBtn\");\n      loginBtn.disabled = true;\n      loginBtn.style.cursor = \"not-allowed\";\n    };\n\n    this.enableLoginBtn = () => {\n      const loginBtn = document.querySelector(\"#loginBtn\");\n      loginBtn.disabled = false;\n      loginBtn.style.cursor = \"pointer\";\n    };\n\n    this.notifyUserAboutInvalidUserName = () => {\n      this.usernameInputField.style.border = \"2px solid red\";\n    };\n\n    this.notifyUserAboutInvalidPassword = () => {\n      this.passwordInputField.style.border = \"2px solid red\";\n    };\n\n    this.resetInputFields = () => {\n      this.usernameInputField.style.border = \"1px solid #00d1ff\";\n      this.passwordInputField.style.border = \"1px solid #00d1ff\";\n      this.userMessagesParagraph.textContent = \"\";\n    };\n\n    this.loginErrorHandler = errorMessage => {\n      // Letting the user know he received an error, by displaying the error message\n      this.userMessagesParagraph.textContent = errorMessage;\n    };\n\n    this.state = {\n      userName: \"\",\n      password: \"\"\n    };\n  } // ------------------------------------------------- Component Settings ------------------------------------------------- //\n\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"loginSectionContainer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(TopBanner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"loginSection\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"loginSquare\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"login-logo\",\n      src: logo,\n      alt: \"Explorer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"sharp-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 25\n      }\n    }, \"Login\"), /*#__PURE__*/React.createElement(\"h3\", {\n      className: \"sharp-text margin-bottom-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 25\n      }\n    }, \"To Continue To Explorer\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"inputFieldSection\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"fieldset\", {\n      id: \"usernameFieldset\",\n      className: \"cerdinals-fieldset\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"legend\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 33\n      }\n    }, \"Username\"), /*#__PURE__*/React.createElement(\"input\", {\n      onChange: this.updateUserNameValue,\n      type: \"text\",\n      name: \"username\",\n      id: \"usernameField\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(\"fieldset\", {\n      id: \"passwordFieldset\",\n      className: \"cerdinals-fieldset\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"legend\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 33\n      }\n    }, \"Password\"), /*#__PURE__*/React.createElement(\"input\", {\n      onChange: this.updatePasswordValue,\n      type: \"password\",\n      name: \"password\",\n      id: \"passwordField\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"loginBtn\",\n      id: \"loginBtn\",\n      onClick: this.login,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 29\n      }\n    }, \"Login\")), /*#__PURE__*/React.createElement(NavLink, {\n      className: \"notRegisteredLink sharp-text\",\n      to: \"/register\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 25\n      }\n    }, \"I Don't Have An Account\")), /*#__PURE__*/React.createElement(\"p\", {\n      id: \"userMessagesParagraph\",\n      className: \"userMessagesParagraph sharp-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 21\n      }\n    })));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Ben/Desktop/John Bryce/פרוייקטים/project3 - Vacations/client/src/components/loginPage/LoginPage.tsx"],"names":["React","Component","UserLoginDetails","NavLink","axios","store","ActionType","TopBanner","successfulLoginHandler","LoginPage","constructor","props","usernameInputField","passwordInputField","userMessagesParagraph","componentDidMount","checkIfGlobalStoreHasAllVacations","document","querySelector","getAllVacationsFromServer","response","get","allVacations","data","dispatch","type","GetAllVacations","payload","error","errorMessage","loginErrorHandler","login","resetInputFields","userNameIsNotEmpty","checkIfUsernameEnteredIsEmpty","passwordIsNotEmpty","checkIfPasswordEnteredIsEmpty","disableLoginButton","userLoginDetails","state","userName","password","serverResponse","post","serverResponseData","enableLoginBtn","routingHandler","allVacationsInGlobalStore","getState","length","updateUserNameValue","event","userNameInputField","target","userNameInputFieldValue","value","trimmedUserNameInputFieldValue","trim","setState","updatePasswordValue","passwordInputFieldValue","initiateSocket","userTokenForSocketIdentification","JSON","parse","sessionStorage","getItem","token","socket","socketIOClient","query","ConnectToSocket","registerAllSocketListeners","notifyUserAboutInvalidUserName","notifyUserAboutInvalidPassword","history","push","loginBtn","disabled","style","cursor","border","textContent","render","logo"],"mappings":"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","sourcesContent":["import React, { ChangeEvent, Component } from 'react';\r\nimport logo from '../../assets/astronautSVG.svg';\r\nimport UserLoginDetails from '../../models/UserLoginDetails';\r\nimport SuccessfulLoginServerResponse from '../../models/SuccessfulLoginServerResponse';\r\nimport { NavLink } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport './loginPage.css';\r\nimport Vacation from '../../models/Vacation';\r\nimport { store } from '../../Redux/Store';\r\nimport { ActionType } from '../../Redux/ActionType';\r\nimport TopBanner from '../topBanner/TopBanner';\r\nimport { successfulLoginHandler } from \"../../models/SuccessfulLoginHandler\";\r\n\r\n\r\n// ------------------------------------------------- This Component Displays The Login Screen ------------------------------------------------- //\r\n\r\ninterface LoginState {\r\n    userName: string;\r\n    password: string;\r\n}\r\n\r\nexport default class LoginPage extends Component <any, LoginState> {\r\n\r\n    // Defining the global DOM elemends\r\n    private usernameInputField: HTMLFieldSetElement;\r\n    private passwordInputField: HTMLFieldSetElement;\r\n    private userMessagesParagraph: HTMLParagraphElement;\r\n\r\n    public constructor (props: any) {\r\n        super(props);\r\n\r\n        // initializing the state with empty values\r\n        this.state = {\r\n             userName: \"\",\r\n             password: \"\"\r\n        };\r\n    }\r\n\r\n\r\n    // ------------------------------------------------- Component Settings ------------------------------------------------- //\r\n\r\n    componentDidMount = () => {\r\n\r\n        // Checking if the Global Store has the vacations.\r\n        // If not, retrieve them before the user even logs in, in order to load\r\n        // the vacations behind the scenes, while the user is bussy logging -> Better UX\r\n        this.checkIfGlobalStoreHasAllVacations();\r\n\r\n        // Defining global DOM elements\r\n        this.usernameInputField = document.querySelector(\"#usernameFieldset\") as HTMLFieldSetElement;\r\n        this.passwordInputField = document.querySelector(\"#passwordFieldset\") as HTMLFieldSetElement;\r\n        this.userMessagesParagraph = document.querySelector(\"#userMessagesParagraph\") as HTMLParagraphElement;\r\n    }\r\n\r\n\r\n\r\n    // ------------------------------------------------- Model ------------------------------------------------- //\r\n\r\n    private getAllVacationsFromServer = async () => {\r\n        \r\n        try {\r\n            // The response we get, should be type of 'Vacation' class\r\n            const response = await axios.get<Vacation[]>('http://localhost:3001/vacations');\r\n\r\n            // Here we are receiving all the vacations from the server, as a JSON\r\n            const allVacations : Vacation[] = response.data;\r\n\r\n            // Updating the Global Store\r\n            store.dispatch({\r\n                type: ActionType.GetAllVacations,\r\n                payload: allVacations\r\n            });\r\n        }\r\n\r\n        catch (error) {\r\n\r\n            try {\r\n                let errorMessage = error.response.data.error;\r\n                this.loginErrorHandler(errorMessage);\r\n            }\r\n\r\n            catch {\r\n                this.loginErrorHandler(error)\r\n            }\r\n        }\r\n    }\r\n\r\n    private login = async () => {\r\n\r\n        this.resetInputFields();\r\n\r\n        let userNameIsNotEmpty = this.checkIfUsernameEnteredIsEmpty();\r\n        let passwordIsNotEmpty = this.checkIfPasswordEnteredIsEmpty();\r\n\r\n        if (userNameIsNotEmpty && passwordIsNotEmpty) {\r\n\r\n            try {\r\n                this.disableLoginButton();\r\n\r\n                let userLoginDetails = new UserLoginDetails(this.state.userName, this.state.password);\r\n                \r\n                // The response we get, should be type of 'SuccessfulLoginServerResponse' class\r\n                const serverResponse = await axios.post<SuccessfulLoginServerResponse>('http://localhost:3001/users/login', userLoginDetails);\r\n    \r\n                // Here we are receiving the token, username & user type from the data we got back from the server\r\n                const serverResponseData = serverResponse.data;\r\n\r\n                // A Model that handles a successful login response from the server\r\n                successfulLoginHandler(serverResponseData);\r\n\r\n                this.enableLoginBtn();\r\n\r\n                // Handling the URL routing\r\n                this.routingHandler();\r\n            }\r\n    \r\n            catch (error) {\r\n                \r\n                try {\r\n                    let errorMessage = error.response.data.error;\r\n                    this.loginErrorHandler(errorMessage);\r\n                }\r\n\r\n                catch {\r\n                    this.loginErrorHandler(error);\r\n                }\r\n\r\n                finally {\r\n                    this.enableLoginBtn();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    // ------------------------------------------------- Controller ------------------------------------------------- //\r\n\r\n    private checkIfGlobalStoreHasAllVacations = () => {\r\n\r\n        let allVacationsInGlobalStore = store.getState().allVacations;\r\n\r\n        if (allVacationsInGlobalStore.length === 0) {\r\n            this.getAllVacationsFromServer()\r\n        }\r\n    }\r\n\r\n    private updateUserNameValue = (event : ChangeEvent <HTMLInputElement>) => {\r\n\r\n        // getting the username entered in the username's input field\r\n\r\n        const userNameInputField : HTMLInputElement = event.target;\r\n        const userNameInputFieldValue : string =  userNameInputField.value;\r\n        const trimmedUserNameInputFieldValue : string = userNameInputFieldValue.trim();\r\n\r\n        this.setState({\r\n            userName: trimmedUserNameInputFieldValue\r\n        });\r\n    }\r\n\r\n    private updatePasswordValue = (event : ChangeEvent <HTMLInputElement>) => {\r\n\r\n        // getting the password entered in the password's input field\r\n\r\n        const passwordInputField : HTMLInputElement = event.target;\r\n        const passwordInputFieldValue : string =  passwordInputField.value;\r\n\r\n        this.setState({\r\n            password: passwordInputFieldValue\r\n        });\r\n    }\r\n\r\n    private initiateSocket = () => {\r\n\r\n        // Connecting to the server's socket\r\n        const userTokenForSocketIdentification = JSON.parse(sessionStorage.getItem('userInfo')).token;\r\n        \r\n        this.socket = socketIOClient('http://localhost:3002', { query: \"userToken=\" + userTokenForSocketIdentification});\r\n        store.dispatch({type: ActionType.ConnectToSocket, payload: this.socket});\r\n        this.registerAllSocketListeners();\r\n    }\r\n\r\n    private checkIfUsernameEnteredIsEmpty = () => {\r\n\r\n        // Checking if the username entered in the 'login' page is empty\r\n\r\n        let userNameInputField: HTMLInputElement = document.querySelector(\"#usernameField\") as HTMLInputElement;\r\n        let userNameInputFieldValue = userNameInputField.value;\r\n        let trimmedUserNameInputFieldValue = userNameInputFieldValue.trim();\r\n\r\n        if (trimmedUserNameInputFieldValue === \"\") {\r\n            this.notifyUserAboutInvalidUserName();\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private checkIfPasswordEnteredIsEmpty = () => {\r\n\r\n        // Checking if the password entered in the 'login' page is empty\r\n\r\n        let passwordInputField: HTMLInputElement = document.querySelector(\"#passwordField\") as HTMLInputElement;\r\n        let passwordInputFieldValue = passwordInputField.value;\r\n        let trimmedUserNameInputFieldValue = passwordInputFieldValue.trim();\r\n\r\n        if (trimmedUserNameInputFieldValue === \"\") {\r\n            this.notifyUserAboutInvalidPassword();\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private routingHandler = () => {\r\n\r\n        // Navigating To The Vacations Page URL After a Successful Login\r\n        this.props.history.push('/vacations');\r\n    }\r\n\r\n\r\n\r\n    // ------------------------------------------------- View ------------------------------------------------- //\r\n\r\n    private disableLoginButton = () : void => {\r\n        const loginBtn = document.querySelector(\"#loginBtn\") as HTMLButtonElement;\r\n        loginBtn.disabled = true;\r\n        loginBtn.style.cursor = \"not-allowed\";\r\n    }\r\n\r\n    private enableLoginBtn = () : void => {\r\n        const loginBtn = document.querySelector(\"#loginBtn\") as HTMLButtonElement;\r\n        loginBtn.disabled = false;\r\n        loginBtn.style.cursor = \"pointer\";\r\n    }\r\n\r\n    private notifyUserAboutInvalidUserName = () => {\r\n        this.usernameInputField.style.border = \"2px solid red\";\r\n    }\r\n\r\n    private notifyUserAboutInvalidPassword = () => {\r\n        this.passwordInputField.style.border = \"2px solid red\";\r\n    }\r\n\r\n    private resetInputFields = () => {\r\n\r\n        this.usernameInputField.style.border = \"1px solid #00d1ff\";\r\n        this.passwordInputField.style.border = \"1px solid #00d1ff\";\r\n\r\n        this.userMessagesParagraph.textContent = \"\";\r\n    }\r\n\r\n    private loginErrorHandler = (errorMessage : string) => {\r\n\r\n        // Letting the user know he received an error, by displaying the error message\r\n        this.userMessagesParagraph.textContent = errorMessage;\r\n    }\r\n\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"loginSectionContainer\">\r\n                <TopBanner />\r\n\r\n                <div className=\"loginSection\">\r\n                    <div className=\"loginSquare\">\r\n                        <img className=\"login-logo\" src={logo} alt=\"Explorer\"/>\r\n\r\n                        <h2 className=\"sharp-text\">Login</h2>\r\n                        <h3 className=\"sharp-text margin-bottom-2\">To Continue To Explorer</h3>\r\n\r\n\r\n                        <div className=\"inputFieldSection\">\r\n                            <fieldset id=\"usernameFieldset\" className=\"cerdinals-fieldset\">\r\n                                <legend>Username</legend>\r\n                                <input onChange={this.updateUserNameValue} type=\"text\" name=\"username\" id=\"usernameField\"/>\r\n                            </fieldset>\r\n\r\n                            <fieldset id=\"passwordFieldset\" className=\"cerdinals-fieldset\">\r\n                                <legend>Password</legend>\r\n                                <input onChange={this.updatePasswordValue} type=\"password\" name=\"password\" id=\"passwordField\"/>\r\n                            </fieldset>\r\n\r\n                            <button className=\"loginBtn\" id=\"loginBtn\" onClick={this.login}>Login</button>\r\n                        </div>\r\n\r\n                        <NavLink className=\"notRegisteredLink sharp-text\" to=\"/register\">I Don't Have An Account</NavLink>\r\n                    </div>\r\n\r\n                    <p id=\"userMessagesParagraph\" className=\"userMessagesParagraph sharp-text\"></p>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}